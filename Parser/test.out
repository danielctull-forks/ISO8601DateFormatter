cc -std=c99   -c -o NSCalendarDate+ISO8601Parsing.o NSCalendarDate+ISO8601Parsing.m
cc -framework Foundation  testprog.o NSCalendarDate+ISO8601Parsing.o   -o testprog
./test.sh

Tests with a date only:
% ./testprog 2006-02-24 2006-12 2006 2006- 2006-02- 2006-0224 200602-24 20060224 2001-W1-1 2002-W1-1 2003-W1-1 2004-W1-1 2010-W1-1 2000-W1-1 2006-W1-1 2006-W1-2 2006-W02 2006-W2 2006-W02-01 2006-W02-1 2006-W2-01 2006-W2-1 2006-W2-2 2006-W2-8 2006-W3-1 2006-W22 2006-W22-11 06-02-24 06-12 06-02- 06-0224 0602-24 060224 06-W22 06-W2 06-W22-11 06-W2-1 -6-02-24 -6-12 -6 -6- -6-02- -6-0224 -602-24 -6-W22 -6-W2 -6-W22-11 -6-W2-1 --0224 --02-24 --2-24 --02-2 --02 ---24 -W2 -W2-11 -W-3 --W-3 2006-001 2006-002 2006-055 2006-365 2004-001 2004-366 -055 --055 2006T
2006-02-24 → 2006-02-24 00:00:00 -0800
2006-12 → 2006-12-01 00:00:00 -0800
2006 → 2006-01-01 00:00:00 -0800
2006- → 2006-01-01 00:00:00 -0800
2006-02- → 2006-02-01 00:00:00 -0800
2006-0224 → 2006-02-24 00:00:00 -0800
200602-24 → 2020-06-02 00:00:00 -0700
20060224 → 2006-02-24 00:00:00 -0800
2001-W1-1 → 2001-01-01 00:00:00 -0800
2002-W1-1 → 2001-12-31 00:00:00 -0800
2003-W1-1 → 2002-12-30 00:00:00 -0800
2004-W1-1 → 2003-12-29 00:00:00 -0800
2010-W1-1 → 2010-01-04 00:00:00 -0800
2000-W1-1 → 2000-01-03 00:00:00 -0800
2006-W1-1 → 2006-01-02 00:00:00 -0800
2006-W1-2 → 2006-01-03 00:00:00 -0800
2006-W02 → 2006-01-09 00:00:00 -0800
2006-W2 → 2006-01-09 00:00:00 -0800
2006-W02-01 → 2006-01-09 00:00:00 -0800
2006-W02-1 → 2006-01-09 00:00:00 -0800
2006-W2-01 → 2006-01-09 00:00:00 -0800
2006-W2-1 → 2006-01-09 00:00:00 -0800
2006-W2-2 → 2006-01-10 00:00:00 -0800
2006-W2-8 → 2006-01-16 00:00:00 -0800
2006-W3-1 → 2006-01-16 00:00:00 -0800
2006-W22 → 2006-05-29 00:00:00 -0700
2006-W22-11 → 2006-06-08 00:00:00 -0700
06-02-24 → 2006-02-24 00:00:00 -0800
06-12 → 2006-12-01 00:00:00 -0800
06-02- → 2006-02-01 00:00:00 -0800
06-0224 → 2006-02-24 00:00:00 -0800
0602-24 → 602-05-03 00:00:00 -0800
060224 → 2006-02-24 00:00:00 -0800
06-W22 → 2006-05-29 00:00:00 -0700
06-W2 → 2006-01-09 00:00:00 -0800
06-W22-11 → 2006-06-08 00:00:00 -0700
06-W2-1 → 2006-01-09 00:00:00 -0800
-6-02-24 → 2006-02-01 00:00:00 -0800
-6-12 → 2006-12-01 00:00:00 -0800
-6 → 2006-01-01 00:00:00 -0800
-6- → 2006-01-01 00:00:00 -0800
-6-02- → 2006-02-01 00:00:00 -0800
-6-0224 → 2006-02-02 00:00:00 -0800
-602-24 → 2007-08-25 00:00:00 -0700
-6-W22 → 2006-02-01 02:00:00 -0800
-6-W2 → 2006-02-01 00:00:00 -0800
-6-W22-11 → 2006-02-01 02:00:00 -1100
-6-W2-1 → 2006-02-01 00:00:00 -0800
--0224 → 2006-02-24 00:00:00 -0800
--02-24 → 2006-02-24 00:00:00 -0800
--2-24 → 2006-02-24 00:00:00 -0800
--02-2 → 2006-02-02 00:00:00 -0800
--02 → 2006-01-31 00:00:00 -0800
---24 → 2006-05-24 00:00:00 -0700
-W2 → 2006-01-09 00:00:00 -0800
-W2-11 → 2006-01-19 00:00:00 -0800
-W-3 → 2006-01-04 00:00:00 -0800
--W-3 → 2006-01-04 00:00:00 -0800
2006-001 → 2006-01-01 00:00:00 -0800
2006-002 → 2006-01-02 00:00:00 -0800
2006-055 → 2006-02-24 00:00:00 -0800
2006-365 → 2006-12-31 00:00:00 -0800
2004-001 → 2004-01-01 00:00:00 -0800
2004-366 → 2004-12-31 00:00:00 -0800
-055 → 2006-02-24 00:00:00 -0800
--055 → 2006-02-24 00:00:00 -0800
2006T → 2006-01-01 00:00:00 -0800

Current year in x century:
% ./testprog 20 1
20 → 2006-01-01 00:00:00 -0800
1 → 106-01-01 00:00:00 -0800

x year in current century:
% ./testprog -06
-06 → 2006-01-02 00:00:00 -0800

x year and month in current century:
% ./testprog -06-02
-06-02 → 2006-02-01 00:00:00 -0800

x year, month, and date in current century:
% ./testprog 06-02-24
06-02-24 → 2006-02-24 00:00:00 -0800

x month and date in current year:
% ./testprog --02-24
--02-24 → 2006-02-24 00:00:00 -0800

x date in current year and month:
% ./testprog ---24
---24 → 2006-05-24 00:00:00 -0700

Tests with a time only:
% ./testprog T22:63:24-11:21 T22:63:24+50:70 T22:1:2 T22:1Z T22: T22 T2 T2:2:2
T22:63:24-11:21 → 2006-05-29 23:03:24 -1121
T22:63:24+50:70 → 2006-05-29 23:03:24 -0700
T22:1:2 → 2006-05-29 22:01:02 -0700
T22:1Z → 2006-05-29 22:01:00 +0000
T22: → 2006-05-29 22:00:00 -0700
T22 → 2006-05-29 22:00:00 -0700
T2 → 2006-05-29 02:00:00 -0700
T2:2:2 → 2006-05-29 02:02:02 -0700

Tests with both a date and a time:
% ./testprog 2006-02-24T02:43:24 2006-02-24T22:43:24 2006-02-24T22:63:24 2006-12T12:34 2006T22
2006-02-24T02:43:24 → 2006-02-24 02:43:24 -0800
2006-02-24T22:43:24 → 2006-02-24 22:43:24 -0800
2006-02-24T22:63:24 → 2006-02-24 23:03:24 -0800
2006-12T12:34 → 2006-12-01 12:34:00 -0800
2006T22 → 2006-01-01 22:00:00 -0800

Tests with a date, a time, and a time zone:
% ./testprog 2006-02-24T22:63:24-01:00 2006-02-24T22:63:24Z      2006-02-24T22:63:24-1 2006-02-24T22:63:24-01 2006-02-24T22:63:24-01:32 2006-02-24T22:63:24-01:0  2006-02-24T22:63:24-01:00 2006-02-24T22:63:24-01:01 2006-02-24T22:63:24-01:11 2006-02-24T22:63:24-11:21
2006-02-24T22:63:24-01:00 → 2006-02-24 23:03:24 -0100
2006-02-24T22:63:24Z → 2006-02-24 23:03:24 +0000
2006-02-24T22:63:24-1 → 2006-02-24 23:03:24 -0100
2006-02-24T22:63:24-01 → 2006-02-24 23:03:24 -0100
2006-02-24T22:63:24-01:32 → 2006-02-24 23:03:24 -0132
2006-02-24T22:63:24-01:0 → 2006-02-24 23:03:24 -0100
2006-02-24T22:63:24-01:00 → 2006-02-24 23:03:24 -0100
2006-02-24T22:63:24-01:01 → 2006-02-24 23:03:24 -0101
2006-02-24T22:63:24-01:11 → 2006-02-24 23:03:24 -0111
2006-02-24T22:63:24-11:21 → 2006-02-24 23:03:24 -1121

Invalid dates:
% ./testprog  T 2006-W 2006-366 2006-400 2004-367 -2006-02-24T02:43:24 -2006-02-24T22:43:24 -2006-02-24T22:63:24 -2006-12T12:34 -2006T22 -60224 --2006-02-24T02:43:24 --2006-02-24T22:43:24 --2006-02-24T22:63:24 --2006-12T12:34 --2006T22 ---2006-02-24T02:43:24 ---2006-02-24T22:43:24 ---2006-02-24T22:63:24 ---2006-12T12:34 ---2006T22
 → (null)
T → (null)
2006-W → 2006-01-01 00:00:00 -0800
2006-366 → 2007-01-01 00:00:00 -0800
2006-400 → 2007-02-04 00:00:00 -0800
2004-367 → 2005-01-01 00:00:00 -0800
-2006-02-24T02:43:24 → 20-06-02 00:00:00 -0800
-2006-02-24T22:43:24 → 20-06-02 00:00:00 -0800
-2006-02-24T22:63:24 → 20-06-02 00:00:00 -0800
-2006-12T12:34 → 20-06-12 12:34:00 -0800
-2006T22 → 20-06-01 22:00:00 -0800
-60224 → (null)
--2006-02-24T02:43:24 → 2006-09-08 00:00:00 -0700
--2006-02-24T22:43:24 → 2006-09-08 00:00:00 -0700
--2006-02-24T22:63:24 → 2006-09-08 00:00:00 -0700
--2006-12T12:34 → 2006-09-08 00:00:00 -0700
--2006T22 → 2006-09-08 22:00:00 -0700
---2006-02-24T02:43:24 → (null)
---2006-02-24T22:43:24 → (null)
---2006-02-24T22:63:24 → (null)
---2006-12T12:34 → (null)
---2006T22 → (null)
